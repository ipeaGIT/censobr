<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Census tract-level data • censobr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Census tract-level data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">censobr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/censobr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/census_tracts_data.html">Census tract-level data</a></li>
    <li><a class="dropdown-item" href="../articles/documentation.html">Census documentation</a></li>
    <li><a class="dropdown-item" href="../articles/larger_than_memory.html">Working with larger-than-memory data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ipeaGIT/censobr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="census_tracts_data_files/kePrint-0.0.1/kePrint.js"></script><link href="census_tracts_data_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Census tract-level data</h1>
            
            <h4 data-toc-skip class="date">2025-07-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ipeaGIT/censobr/blob/main/vignettes/census_tracts_data.Rmd" class="external-link"><code>vignettes/census_tracts_data.Rmd</code></a></small>
      <div class="d-none name"><code>census_tracts_data.Rmd</code></div>
    </div>

    
    
<p>Perhaps the most commonly used datasets from Brazilian censuses are
the microdata of individuals and households. Nonetheless, IBGE also
makes available some extremely data on population and environmental
characteristics aggregated at the census tract level. In this vignette,
we show how to use the <strong>{censobr}</strong> package to easily
access census tract-level data using the <code><a href="../reference/read_tracts.html">read_tracts()</a></code>
function.</p>
<p>At the moment, this function includes data from the censuses of 2000,
2010 and 2022.</p>
<div class="section level2">
<h2 id="data-structure">Data structure<a class="anchor" aria-label="anchor" href="#data-structure"></a>
</h2>
<p>Aggregated data at the census tract level are split into different
datasets, and some of them are scattered across several files. For the
sake of convenience, we have gathered all of the files into different
datasets:</p>
<table class="table table" style="width: auto !important; ">
<thead><tr>
<th style="text-align:left;">
2000
</th>
<th style="text-align:left;">
2010
</th>
<th style="text-align:left;">
2022
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Basico
</td>
<td style="text-align:left;">
Basico
</td>
<td style="text-align:left;">
Basico
</td>
</tr>
<tr>
<td style="text-align:left;">
Domicilio
</td>
<td style="text-align:left;">
Domicilio
</td>
<td style="text-align:left;">
Domicilio
</td>
</tr>
<tr>
<td style="text-align:left;">
Pessoa
</td>
<td style="text-align:left;">
Pessoa
</td>
<td style="text-align:left;">
Pessoas
</td>
</tr>
<tr>
<td style="text-align:left;">
Responsavel
</td>
<td style="text-align:left;">
Responsavel
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Instrucao
</td>
<td style="text-align:left;">
Entorno
</td>
<td style="text-align:left;">
Entorno
</td>
</tr>
<tr>
<td style="text-align:left;">
Morador
</td>
<td style="text-align:left;">
ResponsavelRenda
</td>
<td style="text-align:left;">
ResponsavelRenda
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
DomicilioRenda
</td>
<td style="text-align:left;">
Indigenas
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
PessoaRenda
</td>
<td style="text-align:left;">
Quilombolas
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Obitos
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Preliminares
</td>
</tr>
</tbody>
</table>
<p>All of the data aggregated at census tracts are organized following
the same logic.</p>
<p>In the cases when there are multiple files in the same dataset, we
add a reference to the number of the file as a prefix to the variable
name. To illustrate this, let’s have a look at the
<code>"Domicilio"</code> dataset. This dataset is based on three
separate tables: <em>Domicilio01</em>, <em>Domicilio02</em> and
<em>Domicilio03</em>. So the names of the columns in this dataset are
organized as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ipeaGIT/censobr" class="external-link">censobr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_tracts.html">read_tracts</a></span><span class="op">(</span></span>
<span>  year <span class="op">=</span> <span class="fl">2022</span>,</span>
<span>  dataset <span class="op">=</span> <span class="st">'Domicilio'</span>, </span>
<span>  showProgress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Downloading data and storing it locally for future use.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dom</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span><span class="op">:</span><span class="fl">33</span>,<span class="fl">119</span><span class="op">:</span><span class="fl">121</span>, <span class="fl">526</span><span class="op">:</span><span class="fl">528</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] "domicilio01_V00001" "domicilio01_V00002" "domicilio01_V00003"</span></span>
<span><span class="co">#&gt;  [4] "domicilio01_V00004" "domicilio02_V00090" "domicilio02_V00091"</span></span>
<span><span class="co">#&gt;  [7] "domicilio02_V00092" "domicilio03_V00497" "domicilio03_V00498"</span></span>
<span><span class="co">#&gt; [10] "domicilio03_V00499"</span></span></code></pre></div>
<div class="section level3">
<h3 id="dictionary-of-variables">Dictionary of variables<a class="anchor" aria-label="anchor" href="#dictionary-of-variables"></a>
</h3>
<p>To check the meaning of each variable, users can run the
<code><a href="../reference/data_dictionary.html">data_dictionary()</a></code>, which will open the file with the
dictionary of variables in each dataset. The dictionary file is either
an <code>.html</code>, a <code>.pdf</code> or an <code>.xlsx</code>
file, depending on the data set and year.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/data_dictionary.html">data_dictionary</a></span><span class="op">(</span></span>
<span>  year <span class="op">=</span> <span class="fl">2022</span>, </span>
<span>  dataset <span class="op">=</span> <span class="st">'tracts'</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="reproducible-examples">Reproducible examples<a class="anchor" aria-label="anchor" href="#reproducible-examples"></a>
</h2>
<p>Now let’s use a couple reproducible examples to illustrate how to
work with census tract-level data. First, we need to load the libraries
we’ll be using in this vignette.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/apache/arrow/" class="external-link">arrow</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ipeagit.github.io/geobr/" class="external-link">geobr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>In these examples below, example we’ll use the city of Belo Horizonte
for demonstration purposes. So we can start by downloading the the
geometries of the census tracts in the area. First, we need to download
the geometries of all census tracts in the state of Minas Gerais (MG),
and then keep only the ones in the municipality of Belo Horizonte. We’ll
also download the municipality borders of BH.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">muni_bh</span> <span class="op">&lt;-</span> <span class="fu">geobr</span><span class="fu">::</span><span class="fu"><a href="https://ipeagit.github.io/geobr/reference/read_municipality.html" class="external-link">read_municipality</a></span><span class="op">(</span></span>
<span>  code_muni <span class="op">=</span> <span class="st">'MG'</span>, </span>
<span>  year <span class="op">=</span> <span class="fl">2010</span>, </span>
<span>  showProgress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">name_muni</span> <span class="op">==</span> <span class="st">"Belo Horizonte"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using year/date 2010</span></span>
<span></span>
<span><span class="va">tracts_sf</span> <span class="op">&lt;-</span> <span class="fu">geobr</span><span class="fu">::</span><span class="fu"><a href="https://ipeagit.github.io/geobr/reference/read_census_tract.html" class="external-link">read_census_tract</a></span><span class="op">(</span></span>
<span>  code_tract <span class="op">=</span> <span class="st">"MG"</span>,</span>
<span>  simplified <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  year <span class="op">=</span> <span class="fl">2010</span>,</span>
<span>  showProgress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Using year/date 2010</span></span>
<span></span>
<span><span class="va">tracts_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tracts_sf</span>, <span class="va">name_muni</span> <span class="op">==</span> <span class="st">"Belo Horizonte"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tracts_sf</span>, fill <span class="op">=</span> <span class="st">'gray90'</span>, color<span class="op">=</span><span class="st">'gray60'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="census_tracts_data_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
<div class="section level3">
<h3 id="example-1">Example 1:<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h3>
<p>In this first example we are going to map the proportion of
households with the presence of trees in their surroundings. To do this,
we need to download the <code>"Entorno"</code> dataset and sum the
variables
<code>domicilios_V05031 + domicilios_V05032 + domicilios_V05033</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># download data</span></span>
<span><span class="va">tract_entorno</span> <span class="op">&lt;-</span> <span class="fu">censobr</span><span class="fu">::</span><span class="fu"><a href="../reference/read_tracts.html">read_tracts</a></span><span class="op">(</span></span>
<span>  year <span class="op">=</span> <span class="fl">2022</span>,</span>
<span>  dataset <span class="op">=</span> <span class="st">"Entorno"</span>, </span>
<span>  showProgress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Downloading data and storing it locally for future use.</span></span>
<span></span>
<span><span class="co"># filter observations and calculate indicator</span></span>
<span><span class="va">df_trees</span> <span class="op">&lt;-</span> <span class="va">tract_entorno</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">code_tract</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">tracts_sf</span><span class="op">$</span><span class="va">code_tract</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">code_tract</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>total_households <span class="op">=</span> <span class="va">domicilios_V05000</span>,</span>
<span>         trees <span class="op">=</span> <span class="va">domicilios_V05031</span> <span class="op">+</span> <span class="va">domicilios_V05032</span><span class="op">+</span> <span class="va">domicilios_V05033</span>,</span>
<span>         trees_prop <span class="op">=</span> <span class="va">trees</span> <span class="op">/</span> <span class="va">total_households</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">code_tract</span>, <span class="va">total_households</span>, <span class="va">trees</span>, <span class="va">trees_prop</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_trees</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   code_tract [6]</span></span></span>
<span><span class="co">#&gt;   code_tract      total_households trees trees_prop</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 310620005620001              222   222      1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 310620005620002              158   158      1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 310620005620004              294   294      1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 310620005620005              131   131      1    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 310620005620006              142   138      0.972</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 310620005620007              218   218      1</span></span></code></pre></div>
<p>Now we can merge the spatial data with our indicator and see how the
presence of trees in the surroundings of households varies
spatially.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bh_tracts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">tracts_sf</span>, <span class="va">df_trees</span>, by <span class="op">=</span> <span class="st">'code_tract'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bh_tracts</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">trees_prop</span><span class="op">)</span>, color<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">muni_bh</span>, color<span class="op">=</span><span class="st">'gray10'</span>, fill<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle <span class="op">=</span> <span class="st">'Share of households with trees in their surroundings.\nBelo Horizonte, 2010'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Greens"</span>, direction <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                       name<span class="op">=</span><span class="st">'Share of\nhouseholds'</span>, </span>
<span>                       na.value <span class="op">=</span> <span class="st">"gray90"</span>,</span>
<span>                       labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="census_tracts_data_files/figure-html/unnamed-chunk-7-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="example-2-spatial-distribution-of-income">Example 2: Spatial distribution of income<a class="anchor" aria-label="anchor" href="#example-2-spatial-distribution-of-income"></a>
</h3>
<p>In this second example, we are going to create a map of the spatial
distribution of average income per capita. Unfortunately, this
information was not collected in the 2022 census at the census tract
level, so this example is based on the 2010 data.</p>
<p>In the 2010 census, we can find the information on the the total
number of residents in each census tract in the <code>"Basico"</code>
dataset, variable <code>"V002"</code>. Meanwhile, the information on
income can be found in the <code>"DomicilioRenda"</code> dataset,
variable <code>"V003"</code>.</p>
<p>Using the code below, we download the data and calculate the income
per capita of all census tracts in Brazil.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># download data</span></span>
<span><span class="va">tract_basico</span> <span class="op">&lt;-</span> <span class="fu">censobr</span><span class="fu">::</span><span class="fu"><a href="../reference/read_tracts.html">read_tracts</a></span><span class="op">(</span></span>
<span>  year <span class="op">=</span> <span class="fl">2010</span>,</span>
<span>  dataset <span class="op">=</span> <span class="st">"Basico"</span>, </span>
<span>  showProgress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Downloading data and storing it locally for future use.</span></span>
<span></span>
<span><span class="va">tract_income</span> <span class="op">&lt;-</span> <span class="fu">censobr</span><span class="fu">::</span><span class="fu"><a href="../reference/read_tracts.html">read_tracts</a></span><span class="op">(</span></span>
<span>  year <span class="op">=</span> <span class="fl">2010</span>,</span>
<span>  dataset <span class="op">=</span> <span class="st">"DomicilioRenda"</span>, </span>
<span>  showProgress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Downloading data and storing it locally for future use.</span></span>
<span></span>
<span><span class="co"># select columns</span></span>
<span><span class="va">tract_basico</span> <span class="op">&lt;-</span> <span class="va">tract_basico</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">'code_tract'</span>,<span class="st">'V002'</span><span class="op">)</span></span>
<span><span class="va">tract_income</span> <span class="op">&lt;-</span> <span class="va">tract_income</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">'code_tract'</span>,<span class="st">'V003'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># merge</span></span>
<span><span class="va">tracts_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">tract_basico</span>, <span class="va">tract_income</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate income per capita</span></span>
<span><span class="va">tracts_df</span> <span class="op">&lt;-</span> <span class="va">tracts_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>income_pc <span class="op">=</span> <span class="va">V003</span> <span class="op">/</span> <span class="va">V002</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tracts_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   code_tract       V002   V003 income_pc</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 110001505000001   956 <span style="text-decoration: underline;">522</span>231      546.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 110001505000002   859 <span style="text-decoration: underline;">406</span>191      473.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 110001505000003   661 <span style="text-decoration: underline;">241</span>587      365.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 110001505000004   266  <span style="text-decoration: underline;">88</span>502      333.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 110001505000005  <span style="text-decoration: underline;">1</span>206 <span style="text-decoration: underline;">262</span>860      218.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 110001505000006   816 <span style="text-decoration: underline;">262</span>968      322.</span></span></code></pre></div>
<p>Finally, we can merge the spatial data with our per capita income
estimates and map the results.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bh_tracts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">tracts_sf</span>, <span class="va">tracts_df</span>, by <span class="op">=</span> <span class="st">'code_tract'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bh_tracts</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">income_pc</span><span class="op">)</span>, color<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">muni_bh</span>, color<span class="op">=</span><span class="st">'gray10'</span>, fill<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle <span class="op">=</span> <span class="st">'Avgerage income per capita.\nBelo Horizonte, 2010'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Income per\ncapita (R$)"</span>,</span>
<span>                       labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">number_format</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                       option <span class="op">=</span> <span class="st">'cividis'</span>,</span>
<span>                       breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">500</span>, <span class="fl">1e3</span>, <span class="fl">5e3</span>, <span class="fl">1e4</span>, <span class="fl">2e4</span><span class="op">)</span>,</span>
<span>                       trans <span class="op">=</span> <span class="st">"pseudo_log"</span>, na.value <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="census_tracts_data_files/figure-html/unnamed-chunk-9-1.png" width="100%"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rafael H. M. Pereira, Rogério J. Barbosa, Ipea - Institute for Applied Economic Research.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
