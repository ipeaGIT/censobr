<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Census tract-level data • censobr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Census tract-level data">
<meta property="og:description" content="censobr">
<meta property="og:image" content="/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">censobr</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.2.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/censobr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/census_tracts_data.html">Census tract-level data</a>
    </li>
    <li>
      <a href="../articles/documentation.html">Census documentation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ipeaGIT/censobr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Census tract-level data</h1>
            
            <h4 data-toc-skip class="date">2024-01-08</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ipeaGIT/censobr/tree/main/vignettes/census_tracts_data.Rmd" class="external-link"><code>vignettes/census_tracts_data.Rmd</code></a></small>
      <div class="hidden name"><code>census_tracts_data.Rmd</code></div>

    </div>

    
    
<p>Perhaps the most commonly used datasets from Brazilian censuses are
the microdata of individuals and households. Nonetheless, IBGE also
makes available some extremely data on population and environmental
characteristics aggregated at the census tract level. In this vignette,
we show how to use the <strong>censobr</strong> package to easily access
census tract-level data using the <code><a href="../reference/read_tracts.html">read_tracts()</a></code>
function.</p>
<p>At the moment, this function only includes data from the 2010
census.</p>
<div class="section level2">
<h2 id="data-structure">Data structure<a class="anchor" aria-label="anchor" href="#data-structure"></a>
</h2>
<p>Aggregated data at the census tract level are split into different
datasets, and some of them are scattered across several files. For the
sake of convenience, we have gathered all of the files into 8 different
datasets:</p>
<ul>
<li><code>"Basico"</code></li>
<li><code>"Entorno"</code></li>
<li><code>"Domicilio"</code></li>
<li><code>"Pessoa"</code></li>
<li><code>"Responsavel"</code></li>
<li><code>"PessoaRenda"</code></li>
<li><code>"DomicilioRenda"</code></li>
<li><code>"ResponsavelRenda"</code></li>
</ul>
<p>All of the data aggregated at census tracts are organized following
the same logic.</p>
<p>In the cases when there are multiple files in the same dataset, we
add a reference to the number of the file as a prefix to the variable
name. To illustrate this, let’s have a look at the
<code>"Domicilio"</code> dataset. This dataset is based on two separate
tables: <em>Domicilio01</em> and <em>Domicilio02</em>. So the names of
the columns in this dataset are organized as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ipeaGIT/censobr" class="external-link">censobr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_tracts.html">read_tracts</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2010</span>, </span>
<span>                   dataset <span class="op">=</span> <span class="st">'Domicilio'</span>, </span>
<span>                   showProgress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Downloading data and storing it locally for future use.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dom</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="fl">301</span><span class="op">:</span><span class="fl">320</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] "code_tract"        "code_weighting"    "code_muni"        </span></span>
<span><span class="co">#&gt;  [4] "code_state"        "abbrev_state"      "name_state"       </span></span>
<span><span class="co">#&gt;  [7] "code_region"       "name_region"       "domicilio01_V1005"</span></span>
<span><span class="co">#&gt; [10] "domicilio01_V001"  "domicilio01_V002"  "domicilio01_V003" </span></span>
<span><span class="co">#&gt; [13] "domicilio01_V004"  "domicilio01_V005"  "domicilio01_V006" </span></span>
<span><span class="co">#&gt; [16] "domicilio01_V007"  "domicilio01_V008"  "domicilio01_V009" </span></span>
<span><span class="co">#&gt; [19] "domicilio01_V010"  "domicilio01_V011"  "domicilio02_V050" </span></span>
<span><span class="co">#&gt; [22] "domicilio02_V051"  "domicilio02_V052"  "domicilio02_V053" </span></span>
<span><span class="co">#&gt; [25] "domicilio02_V054"  "domicilio02_V055"  "domicilio02_V056" </span></span>
<span><span class="co">#&gt; [28] "domicilio02_V057"  "domicilio02_V058"  "domicilio02_V059" </span></span>
<span><span class="co">#&gt; [31] "domicilio02_V060"  "domicilio02_V061"  "domicilio02_V062" </span></span>
<span><span class="co">#&gt; [34] "domicilio02_V063"  "domicilio02_V064"  "domicilio02_V065" </span></span>
<span><span class="co">#&gt; [37] "domicilio02_V066"  "domicilio02_V067"  "domicilio02_V068" </span></span>
<span><span class="co">#&gt; [40] "domicilio02_V069"</span></span></code></pre></div>
<div class="section level3">
<h3 id="dictionary-of-variables">Dictionary of variables<a class="anchor" aria-label="anchor" href="#dictionary-of-variables"></a>
</h3>
<p>To check the meaning of each variable, users can run the
<code><a href="../reference/data_dictionary.html">data_dictionary()</a></code>, which will open on the browser an
<code>.html</code> or <code>.pdf</code> file with the dictionary of
variables in each dataset</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data_dictionary</span>(<span class="at">year =</span> <span class="dv">2010</span>, <span class="at">dataset =</span> <span class="st">'tracts'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span>                                                                      <span class="er">|</span>   <span class="dv">0</span>%</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======</span>                                                                <span class="er">|</span>   <span class="dv">8</span>%</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==========</span>                                                            <span class="er">|</span>  <span class="dv">15</span>%</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="er">|================</span>                                                      <span class="er">|</span>  <span class="dv">22</span>%</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=====================</span>                                                 <span class="er">|</span>  <span class="dv">30</span>%</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==========================</span>                                            <span class="er">|</span>  <span class="dv">37</span>%</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============================</span>                                       <span class="er">|</span>  <span class="dv">45</span>%</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=====================================</span>                                 <span class="er">|</span>  <span class="dv">52</span>%</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==========================================</span>                            <span class="er">|</span>  <span class="dv">60</span>%</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="er">|====================================================</span>                  <span class="er">|</span>  <span class="dv">75</span>%</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==========================================================</span>            <span class="er">|</span>  <span class="dv">82</span>%</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============================================================</span>       <span class="er">|</span>  <span class="dv">90</span>%</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="er">|====================================================================</span>  <span class="er">|</span>  <span class="dv">98</span>%</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======================================================================|</span> <span class="dv">100</span>%</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; NULL</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="reproducible-examples">Reproducible examples<a class="anchor" aria-label="anchor" href="#reproducible-examples"></a>
</h2>
<p>Now let’s use a couple reproducible examples to illustrate how to
work with census tract-level data. First, we need to load the libraries
we’ll be using in this vignette.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/apache/arrow/" class="external-link">arrow</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ipeaGIT/geobr" class="external-link">geobr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>In these examples below, example we’ll use the city of Belo Horizonte
for demonstration purposes. So we can start by downloading the the
geometries of the census tracts in the area. First, we need to download
the geometries of all census tracts in the state of Minas Gerais (MG),
and then keep only the ones in the municipality of Belo Horizonte. We’ll
also download the municipality borders of BH.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">muni_bh</span> <span class="op">&lt;-</span> <span class="fu">geobr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geobr/man/read_municipality.html" class="external-link">read_municipality</a></span><span class="op">(</span>code_muni <span class="op">=</span> <span class="st">'MG'</span>, </span>
<span>                                    year <span class="op">=</span> <span class="fl">2010</span>, </span>
<span>                                    showProgress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>           <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">name_muni</span> <span class="op">==</span> <span class="st">"Belo Horizonte"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using year 2010</span></span>
<span></span>
<span><span class="va">tracts_sf</span> <span class="op">&lt;-</span> <span class="fu">geobr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/geobr/man/read_census_tract.html" class="external-link">read_census_tract</a></span><span class="op">(</span>code_tract <span class="op">=</span> <span class="st">"MG"</span>,</span>
<span>                                      simplified <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                      year <span class="op">=</span> <span class="fl">2010</span>,</span>
<span>                                      showProgress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using year 2010</span></span>
<span></span>
<span><span class="va">tracts_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tracts_sf</span>, <span class="va">name_muni</span> <span class="op">==</span> <span class="st">"Belo Horizonte"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tracts_sf</span>, fill <span class="op">=</span> <span class="st">'gray90'</span>, color<span class="op">=</span><span class="st">'gray60'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="census_tracts_data_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
<div class="section level3">
<h3 id="example-1-spatial-distribution-of-income">Example 1: Spatial distribution of income<a class="anchor" aria-label="anchor" href="#example-1-spatial-distribution-of-income"></a>
</h3>
<p>In this first example we’ll be creating a map of the spatial
distribution of average income per capita. We can find the information
on the the total number of residents in each census tract in the
<code>"Basico"</code> dataset, variable <code>"V002"</code>. Meanwhile,
the information on income can be found in the
<code>"DomicilioRenda"</code> dataset, variable <code>"V003"</code>.</p>
<p>Using the code below, we download the data and calculate the income
per capita of all census tracts in Brazil.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># download data</span></span>
<span><span class="va">tract_basico</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_tracts.html">read_tracts</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2010</span>,</span>
<span>                            dataset <span class="op">=</span> <span class="st">"Basico"</span>, </span>
<span>                            showProgress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Downloading data and storing it locally for future use.</span></span>
<span></span>
<span><span class="va">tract_income</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_tracts.html">read_tracts</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2010</span>,</span>
<span>                            dataset <span class="op">=</span> <span class="st">"DomicilioRenda"</span>, </span>
<span>                            showProgress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Downloading data and storing it locally for future use.</span></span>
<span></span>
<span><span class="co"># select columns</span></span>
<span><span class="va">tract_basico</span> <span class="op">&lt;-</span> <span class="va">tract_basico</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">'code_tract'</span>,<span class="st">'V002'</span><span class="op">)</span></span>
<span><span class="va">tract_income</span> <span class="op">&lt;-</span> <span class="va">tract_income</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">'code_tract'</span>,<span class="st">'V003'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># merge</span></span>
<span><span class="va">tracts_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">tract_basico</span>, <span class="va">tract_income</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate income per capita</span></span>
<span><span class="va">tracts_df</span> <span class="op">&lt;-</span> <span class="va">tracts_df</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>income_pc <span class="op">=</span> <span class="va">V003</span> <span class="op">/</span> <span class="va">V002</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tracts_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;         code_tract V002    V003 income_pc</span></span>
<span><span class="co">#&gt; 1: 350320825000030  480  368357  767.4104</span></span>
<span><span class="co">#&gt; 2: 350320825000031  458  293191  640.1550</span></span>
<span><span class="co">#&gt; 3: 350320825000032  955  859297  899.7874</span></span>
<span><span class="co">#&gt; 4: 350320825000033   NA       0        NA</span></span>
<span><span class="co">#&gt; 5: 350320825000034  764  636266  832.8089</span></span>
<span><span class="co">#&gt; 6: 350320825000035 1026 1151032 1121.8635</span></span></code></pre></div>
<p>Finally, we can merge the spatial data with our per capita income
estimates and map the results.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bh_tracts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">tracts_sf</span>, <span class="va">tracts_df</span>, by <span class="op">=</span> <span class="st">'code_tract'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bh_tracts</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">income_pc</span><span class="op">)</span>, color<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">muni_bh</span>, color<span class="op">=</span><span class="st">'gray10'</span>, fill<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle <span class="op">=</span> <span class="st">'Avgerage income per capita.\nBelo Horizonte, 2010'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_c</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Income per\ncapita (R$)"</span>,</span>
<span>                       labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/comma.html" class="external-link">number_format</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                       option <span class="op">=</span> <span class="st">'cividis'</span>,</span>
<span>                       breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">500</span>, <span class="fl">1e3</span>, <span class="fl">5e3</span>, <span class="fl">1e4</span>, <span class="fl">2e4</span><span class="op">)</span>,</span>
<span>                       trans <span class="op">=</span> <span class="st">"pseudo_log"</span>, na.value <span class="op">=</span> <span class="st">"gray90"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="census_tracts_data_files/figure-html/unnamed-chunk-7-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="example-2">Example 2:<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h3>
<p>In this second example, we are going to map the proportion of
households with the presence of trees in their surroundings. To do this,
we need to download the <code>"Entorno"</code> dataset and sum the
variables
<code>entorno01_V044 + entorno01_V046 + entorno01_V048</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># download data</span></span>
<span><span class="va">tract_entorno</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_tracts.html">read_tracts</a></span><span class="op">(</span>year <span class="op">=</span> <span class="fl">2010</span>,</span>
<span>                             dataset <span class="op">=</span> <span class="st">"Entorno"</span>, </span>
<span>                             showProgress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Downloading data and storing it locally for future use.</span></span>
<span></span>
<span><span class="co"># filter observations and calculate indicator</span></span>
<span><span class="va">df_trees</span> <span class="op">&lt;-</span> <span class="va">tract_entorno</span> <span class="op">|&gt;</span></span>
<span>                  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">code_tract</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">tracts_sf</span><span class="op">$</span><span class="va">code_tract</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>                  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>total_households <span class="op">=</span> <span class="va">entorno01_V001</span>,</span>
<span>                         trees <span class="op">=</span> <span class="va">entorno01_V044</span> <span class="op">+</span> <span class="va">entorno01_V046</span> <span class="op">+</span> <span class="va">entorno01_V048</span>,</span>
<span>                         trees_prop <span class="op">=</span> <span class="va">trees</span> <span class="op">/</span> <span class="va">total_households</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>                  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">code_tract</span>, <span class="va">total_households</span>, <span class="va">trees</span>, <span class="va">trees_prop</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>                  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_trees</span><span class="op">)</span></span>
<span><span class="co">#&gt;         code_tract total_households trees trees_prop</span></span>
<span><span class="co">#&gt; 1: 310620005620001              212   212  1.0000000</span></span>
<span><span class="co">#&gt; 2: 310620005620002              189   189  1.0000000</span></span>
<span><span class="co">#&gt; 3: 310620005620003              295   291  0.9864407</span></span>
<span><span class="co">#&gt; 4: 310620005620004              226   200  0.8849558</span></span>
<span><span class="co">#&gt; 5: 310620005620005              295   295  1.0000000</span></span>
<span><span class="co">#&gt; 6: 310620005620006              301   299  0.9933555</span></span></code></pre></div>
<p>Now we can merge the spatial data with our indicator and see how the
presence of trees in the surroundings of households varies
spatially.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bh_tracts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">tracts_sf</span>, <span class="va">df_trees</span>, by <span class="op">=</span> <span class="st">'code_tract'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bh_tracts</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">trees_prop</span><span class="op">)</span>, color<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">muni_bh</span>, color<span class="op">=</span><span class="st">'gray10'</span>, fill<span class="op">=</span><span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle <span class="op">=</span> <span class="st">'Share of households with trees in their surroundings.\nBelo Horizonte, 2010'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html" class="external-link">scale_fill_distiller</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Greens"</span>, direction <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                       name<span class="op">=</span><span class="st">'Share of\nhouseholds'</span>, </span>
<span>                       na.value <span class="op">=</span> <span class="st">"gray90"</span>,</span>
<span>                       labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html" class="external-link">percent</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="census_tracts_data_files/figure-html/unnamed-chunk-9-1.png" width="100%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Rafael H. M. Pereira, Rogério J. Barbosa, Ipea - Institute for Applied Economic Research.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
